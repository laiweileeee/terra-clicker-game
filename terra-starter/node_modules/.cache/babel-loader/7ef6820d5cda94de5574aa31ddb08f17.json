{"ast":null,"code":"import { toCanvas } from 'qrcode';\nimport { isMobile as isMobileBrowser } from '../../utils/browser-check';\nimport { modalStyle } from './modal.style';\nexport class TerraWalletconnectQrcodeModal {\n  constructor() {\n    this.modalContainer = null;\n    this.styleContainer = null;\n    this.callback = null;\n\n    this.setCloseCallback = callback => {\n      this.callback = callback;\n    };\n\n    this.open = (uri, cb, _qrcodeModalOptions) => {\n      var _a, _b;\n\n      const modalContainer = document.createElement('div');\n      const stylecontainer = document.createElement('style');\n      const query = encodeURIComponent(`action=wallet_connect&payload=${encodeURIComponent(uri)}`);\n      const schemeUri = `https://terrastation.page.link/?link=https://terra.money?${query}&apn=money.terra.station&ibi=money.terra.station&isi=1548434735`;\n      const element = createModalElement({\n        schemeUri,\n        onClose: () => {\n          if (this.callback) {\n            this.callback();\n            this.callback = null;\n          }\n\n          this.close();\n        }\n      });\n\n      if (isMobileBrowser()) {\n        window.location.href = schemeUri;\n      }\n\n      stylecontainer.textContent = modalStyle;\n      modalContainer.appendChild(element);\n      (_a = document.querySelector('head')) === null || _a === void 0 ? void 0 : _a.appendChild(stylecontainer);\n      (_b = document.querySelector('body')) === null || _b === void 0 ? void 0 : _b.appendChild(modalContainer);\n      this.modalContainer = modalContainer;\n      this.styleContainer = stylecontainer;\n    };\n\n    this.close = () => {\n      var _a, _b;\n\n      if (this.modalContainer) {\n        (_a = this.modalContainer.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(this.modalContainer);\n      }\n\n      if (this.styleContainer) {\n        (_b = this.styleContainer.parentElement) === null || _b === void 0 ? void 0 : _b.removeChild(this.styleContainer);\n      }\n\n      this.callback = null;\n    };\n  }\n\n}\n\nfunction createModalElement(_ref) {\n  let {\n    schemeUri,\n    onClose\n  } = _ref;\n  const isMobile = isMobileBrowser();\n\n  const openTerraStationMobile = () => {\n    window.location.href = schemeUri;\n  }; // ---------------------------------------------\n  // container\n  // ---------------------------------------------\n\n\n  const container = document.createElement('div');\n  container.setAttribute('class', 'wallet-wc-modal'); // ---------------------------------------------\n  // container > div.wallet-wc-modal--dim\n  // ---------------------------------------------\n\n  const dim = document.createElement('div');\n  dim.setAttribute('class', 'wallet-wc-modal--dim');\n  container.appendChild(dim); // ---------------------------------------------\n  // container > div.wallet-wc-modal--content\n  // ---------------------------------------------\n\n  const content = document.createElement('section');\n  content.setAttribute('class', 'wallet-wc-modal--content');\n  content.setAttribute('data-device', isMobile ? 'mobile' : 'desktop');\n  container.appendChild(content); // h1\n\n  const title = document.createElement('h1');\n  content.appendChild(title);\n  const img = document.createElement('img');\n  img.setAttribute('src', 'https://assets.terra.money/icon/wallet-provider/walletconnect.svg');\n  img.setAttribute('style', 'width: 1em; margin-right: 10px; transform: scale(1.5) translateY(0.08em)');\n  const span = document.createElement('span');\n  span.textContent = 'Wallet Connect';\n  title.appendChild(img);\n  title.appendChild(span); // p\n\n  const description = document.createElement('p');\n  description.textContent = 'Scan QR code with a WalletConnect-compatible wallet';\n  content.appendChild(description);\n\n  if (isMobile) {\n    // button\n    const button = document.createElement('button');\n    button.addEventListener('click', openTerraStationMobile);\n    button.textContent = 'Open Terra Station Mobile';\n    content.appendChild(button);\n  } else {\n    // qrcode\n    const canvas = document.createElement('canvas');\n    toCanvas(canvas, schemeUri, {\n      width: 220,\n      margin: 0,\n      color: {\n        dark: '#2043b5ff'\n      }\n    });\n    content.appendChild(canvas);\n  } // events\n\n\n  dim.addEventListener('click', onClose);\n  return container;\n}","map":{"version":3,"sources":["../../../../../src/@terra-money/wallet-controller/modules/walletconnect/modal.ts"],"names":[],"mappings":"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","sourcesContent":["import { IQRCodeModal, IQRCodeModalOptions } from '@walletconnect/types';\nimport { toCanvas } from 'qrcode';\nimport { isMobile as isMobileBrowser } from '../../utils/browser-check';\nimport { modalStyle } from './modal.style';\n\nexport class TerraWalletconnectQrcodeModal implements IQRCodeModal {\n  modalContainer: HTMLDivElement | null = null;\n  styleContainer: HTMLStyleElement | null = null;\n\n  private callback: (() => void) | null = null;\n\n  setCloseCallback = (callback: () => void) => {\n    this.callback = callback;\n  };\n\n  open = (\n    uri: string,\n    cb: () => void,\n    _qrcodeModalOptions?: IQRCodeModalOptions,\n  ) => {\n    const modalContainer = document.createElement('div');\n    const stylecontainer = document.createElement('style');\n\n    const query = encodeURIComponent(\n      `action=wallet_connect&payload=${encodeURIComponent(uri)}`,\n    );\n\n    const schemeUri = `https://terrastation.page.link/?link=https://terra.money?${query}&apn=money.terra.station&ibi=money.terra.station&isi=1548434735`;\n\n    const element = createModalElement({\n      schemeUri,\n      onClose: () => {\n        if (this.callback) {\n          this.callback();\n          this.callback = null;\n        }\n        this.close();\n      },\n    });\n\n    if (isMobileBrowser()) {\n      window.location.href = schemeUri;\n    }\n\n    stylecontainer.textContent = modalStyle;\n    modalContainer.appendChild(element);\n\n    document.querySelector('head')?.appendChild(stylecontainer);\n    document.querySelector('body')?.appendChild(modalContainer);\n\n    this.modalContainer = modalContainer;\n    this.styleContainer = stylecontainer;\n  };\n\n  close = () => {\n    if (this.modalContainer) {\n      this.modalContainer.parentElement?.removeChild(this.modalContainer);\n    }\n\n    if (this.styleContainer) {\n      this.styleContainer.parentElement?.removeChild(this.styleContainer);\n    }\n\n    this.callback = null;\n  };\n}\n\nfunction createModalElement({\n  schemeUri,\n  onClose,\n}: {\n  schemeUri: string;\n  onClose: () => void;\n}): HTMLElement {\n  const isMobile = isMobileBrowser();\n\n  const openTerraStationMobile = () => {\n    window.location.href = schemeUri;\n  };\n\n  // ---------------------------------------------\n  // container\n  // ---------------------------------------------\n  const container = document.createElement('div');\n  container.setAttribute('class', 'wallet-wc-modal');\n\n  // ---------------------------------------------\n  // container > div.wallet-wc-modal--dim\n  // ---------------------------------------------\n  const dim = document.createElement('div');\n  dim.setAttribute('class', 'wallet-wc-modal--dim');\n\n  container.appendChild(dim);\n\n  // ---------------------------------------------\n  // container > div.wallet-wc-modal--content\n  // ---------------------------------------------\n  const content = document.createElement('section');\n  content.setAttribute('class', 'wallet-wc-modal--content');\n  content.setAttribute('data-device', isMobile ? 'mobile' : 'desktop');\n\n  container.appendChild(content);\n\n  // h1\n  const title = document.createElement('h1');\n  content.appendChild(title);\n\n  const img = document.createElement('img');\n  img.setAttribute(\n    'src',\n    'https://assets.terra.money/icon/wallet-provider/walletconnect.svg',\n  );\n  img.setAttribute(\n    'style',\n    'width: 1em; margin-right: 10px; transform: scale(1.5) translateY(0.08em)',\n  );\n\n  const span = document.createElement('span');\n  span.textContent = 'Wallet Connect';\n\n  title.appendChild(img);\n  title.appendChild(span);\n\n  // p\n  const description = document.createElement('p');\n  description.textContent =\n    'Scan QR code with a WalletConnect-compatible wallet';\n  content.appendChild(description);\n\n  if (isMobile) {\n    // button\n    const button = document.createElement('button');\n    button.addEventListener('click', openTerraStationMobile);\n    button.textContent = 'Open Terra Station Mobile';\n\n    content.appendChild(button);\n  } else {\n    // qrcode\n    const canvas = document.createElement('canvas');\n    toCanvas(canvas, schemeUri, {\n      width: 220,\n      margin: 0,\n      color: {\n        dark: '#2043b5ff',\n      },\n    });\n\n    content.appendChild(canvas);\n  }\n\n  // events\n  dim.addEventListener('click', onClose);\n\n  return container;\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}